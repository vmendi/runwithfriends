<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />
        <title>
        </title>
        <link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/jquery.mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
        <link rel="stylesheet" href="styles.css" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
        <script src="https://ajax.aspnetcdn.com/ajax/jquery.mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>
        <script src="canvas.js"></script>
    </head>
    <body>
        <div id="fb-root"></div>
    
        <div data-role="page" id="LoginPage">
            <div data-role="content">
            <center>
                <img src="LoginFacebook.png" alt="image" onClick="onFBLoginClick();"  /><br/>
                <span id="CurrentCoords"></span><br/>
                <span id="CurrentSpeed"></span>
            </center>
            </div>
        </div>

        <div data-role="page" id="HomePage">
            <div data-role="content">
            <center>
                <div style="position:relative; width:320px;height:460px;">
                    <img style="width: 320px; height: 460px" src="./images/home_bg.png">

                    <div onClick="$.mobile.changePage('#ChallengeReceivedPage');" style='position:absolute;top:0px;left:240px;width:160px;height:160px;'></div>

                </div>                
            </center>
            </div>
        </div>

        <!-- Challenge ReceivedPage -->
        <div id="ChallengeReceivedPage" data-role="page">
          <div data-role="content">
            <center>
                <div style="position:relative; width:320px;height:460px;">
                    <img style="width: 320px; height: 460px" src="./images/race_bg.png">

                    <div onClick="$.mobile.changePage('#HomePage');" style='position:absolute;top:0px;left:0px;width:160px;height:160px;'></div>
                    
                    <div id="randomFriendPicture" style='position:absolute;top:178px;left:23px;'></div>
                    <div id="randomFriendName" style='position:absolute;top:173px;left:66px;' class="my-big-font"></div>
                    <div onClick="$.mobile.changePage('#ChallengeTimeLine');" style='position:absolute;top:228px;left:116px;width:94px;height:46px;'></div>
                </div>
            </center>
          </div>
        </div>

        <!-- Challenge TimeLine -->
        <div id="ChallengeTimeLine" data-role="page">
          <div data-role="content">
            <center>
                <div style="position:relative; width:320px;height:460px;">
                    <img style="width: 320px; height: 460px" src="./images/racing_bg.png">

                    <div onClick="$.mobile.changePage('#HomePage');" style='position:absolute;top:0px;left:0px;width:160px;height:160px;'></div>

                   <img id="progress01" src="./images/Littleguy_Droplet.png" alt="" width="44" height="88" 
                        style="position: absolute; left: 60px; top: 300px;" />
                    <img id="progress02" src="./images/Littleguy_Droplet.png" alt="" width="44" height="88" 
                        style="position: absolute; left: 60px; top: 370px;" />
                </div>
            </center>
          </div>
        </div>

        <script>
            function onFBLoginClick() {
                FB.login(null, {scope: 'email'});
            }

            function onFacebookInitialized() {
                $.mobile.changePage("#ChallengeReceivedPage");
            }

            $(document).ready(function() {
                $(document).bind('pagechange', function(event, data) {
                    var id = data.toPage.attr("id");
                    if (id == "ChallengeReceivedPage") {

                        // Show the user
                        $("#userInfo").html('<img src="https://graph.facebook.com/' + user.id + '/picture">' + user.name);

                        var friend = null;

                        // Pick our favorite judge
                        for(var c=0; c < GlobalFriends.length; c++) {
                            if (GlobalFriends[c].id === "507223094") {
                                friend = GlobalFriends[c];
                                break;
                            }
                        }

                        // Pick a random friend, show him/her
                        if (friend == null)
                            friend = GlobalFriends[Math.round(Math.random()*GlobalFriends.length)-1];

                        //$("#randomFriendInfo").html('<img src="https://graph.facebook.com/' + friend.id + '/picture">' + friend.name);
                        
                        $("#randomFriendPicture").html('<img width="33" height="33" src="https://graph.facebook.com/' +friend.id +'/picture">');
                        $("#randomFriendName").html(friend.name);
                        
                        // Nah, always show our favorite judge
                        $("#randomFriendPicture").html('<img width="33" height="33" src="https://graph.facebook.com/507223094/picture">');
                        $("#randomFriendName").html('Daniel Seeff');
                    }
                    if(data.toPage.attr("id")=="ChallengeTimeLine"){
                        iniciateCanvas();
                    }
                });
            });
        </script>
        <script src="auth.js"></script>
    </body>
</html>