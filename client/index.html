<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />
        <title>
        </title>
        <link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/jquery.mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
        <style>
            /* App custom styles */
        </style>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js">
        </script>
        <script src="https://ajax.aspnetcdn.com/ajax/jquery.mobile/1.1.1/jquery.mobile-1.1.1.min.js">
        </script>
        <script src="canvas.js">
        </script>
    </head>
    <body>
        <div id="fb-root"></div>
    
        <!-- Home -->
        <div data-role="page" id="HomePage">
            <div data-role="content">
            <center>
                <img src="LoginFacebook.png" alt="image" onClick="onFBLoginClick();"  /><br/>
                <span id="CurrentCoords"></span><br/>
                <span id="CurrentSpeed"></span>
            </center>
            </div>
        </div>

        <!-- Challenge ReceivedPage -->
        <div id="ChallengeReceivedPage" data-role="page">
          <div data-role="header">
            <h1>New Challenge!</h1>
          </div>
          <div data-role="content">
            <center>
                <div id="userInfo"></div><br/>
                <p>You have received a new challenge from</p>
                <div id="randomFriendInfo"></div><br/>
                <a href="#ChallengeTimeLine" data-theme="b" class="ui-btn-right" data-transition="flip">Accept Challenge!</a>
            </center>
          </div>
        </div>

        <!-- Challenge TimeLine -->
        <div id="ChallengeTimeLine" data-role="page">
          <div data-role="header">
            <h1>Challenging!</h1>
          </div>
          <div data-role="content">
            <center>
                <p>You are challenging your friend!</p>
                <canvas id="myCanvas" width="320" height="380" style="border:1px solid #000000;"> </canvas>
            </center>
          </div>
        </div>

        <script>
            function onFBLoginClick() {
                FB.login(null, {scope: 'email'});
            }

            function onFacebookInitialized() {
                $.mobile.changePage("#ChallengeReceivedPage");
            }

            $(document).ready(function() {
                $(document).bind('pagechange', function(event, data) {
                    var id = data.toPage.attr("id");
                    if (id == "ChallengeReceivedPage") {

                        // Show the user
                        $("#userInfo").html('<img src="https://graph.facebook.com/' + user.id + '/picture">' + user.name);

                        var friend = null;

                        // Pick our favorite judge
                        for(var c=0; c < GlobalFriends.length; c++) {
                            if (GlobalFriends[c].id === "507223094") {
                                friend = GlobalFriends[c];
                                break;
                            }
                        }

                        // Pick a random friend, show him/her
                        if (friend == null)
                            GlobalFriends[Math.round(Math.random()*GlobalFriends.length)-1];

                        /*
                        $("#randomFriendInfo").html('<img src="https://graph.facebook.com/' + friend.id + '/picture">' + friend.name);
                        */

                        // Nah, always show our favorite judge
                        $("#randomFriendInfo").html('<img src="https://graph.facebook.com/507223094/picture">' + "Daniel Seeff");

                    }
                    if(data.toPage.attr("id")=="ChallengeTimeLine"){
                        iniciateCanvas();
                    }
                });
            });
        </script>
        <script src="auth.js"></script>
    </body>
</html>